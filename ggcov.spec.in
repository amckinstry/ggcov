Summary: GTK+ front end for gcov
Name: @PACKAGE@
Version: @VERSION@
Release: 1
License: GPL
Group: Development/C
Source: http://sourceforge.net/projects/ggcov/files/ggcov-%{version}.tar.gz
Url: http://ggcov.sourceforge.net/
BuildRoot: /var/tmp/%{name}-root
BuildPreReq: gdbm-devel
Vendor: Greg Banks <gnb@users.sourceforge.net>

%description
Ggcov is a simple GUI program for browsing test coverage data from C programs,
and is intended to be a graphical replacement for the gcov program.  See the
ggcov-web package for a WWW interface.

Test coverage data is produced by programs which have been built with "gcc
--coverage", and indicate how many times each line and branch has been
executed, cumulatively over multiple test runs.

%package web
Summary: WWW interface to ggcov
Group: Development/C

%description web
The ggcov-web package provides a WWW interface for browsing test coverage data
from C programs.  See the ggcov package for text-based and GNOME interfaces.

Test coverage data is produced by programs which have been built with "gcc
--coverage", and indicate how many times each line and branch has been
executed, cumulatively over multiple test runs.

%prep
%setup -q

%build
%configure
make

%install
rm -rf $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT

%clean
rm -rf $RPM_BUILD_ROOT

@GCONF@%post
@GCONF@export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
@GCONF@gconftool-2 --makefile-install-rule %{_sysconfdir}/gconf/schemas/ggcov.schemas > /dev/null

%files
%defattr(-,root,root)
%{_bindir}/ggcov
%{_bindir}/tggcov
%{_bindir}/git-history-coverage
%{_datadir}/ggcov/*.glade
%{_datadir}/ggcov/*.png
%{_datadir}/gnome/apps/Development/ggcov.desktop
%{_datadir}/pixmaps/ggcov64.png
@GCONF@%{_sysconfdir}/gconf/schemas/ggcov.schemas
%doc NEWS AUTHORS README INSTALL COPYING ChangeLog TODO
%docdir %{_mandir}
%{_mandir}/man1/ggcov.1*
%{_mandir}/man1/git-history-coverage.1*

%files web
%defattr(-,root,root)
%{_bindir}/ggcov-webdb
%{_datadir}/ggcov/php
%{_localstatedir}/ggcov/tests
%docdir %{_mandir}
%{_mandir}/man1/ggcov-webdb.1*
%doc php/ggcov.conf doc/HOWTO.web

%changelog
* Thu Feb 24 2011 Greg Banks <gnb@users.sourceforge.net>
- Update Homepage, Url, and License metadata.
- Mention --coverage gcc option in description.
* Sun May  9 2010 Greg Banks <gnb@users.sourceforge.net>
- Update email address
* Sun Jun 19 2005 Greg Banks <gnb@alphalink.com.au>
- Add manpage, empty ggcov test dir to web package
* Sat Apr 30 2005 Greg Banks <gnb@alphalink.com.au>
- Added new subpackage for web stuff
* Mon Mar 14 2005 Greg Banks <gnb@alphalink.com.au>
- Added gconf schema
* Thu Jul 17 2003 Greg Banks <gnb@alphalink.com.au>
- Full GTK2 features, GNOME desktop file.
* Sat Nov 24 2001 Greg Banks <gnb@alphalink.com.au>
- Building RPM for first release
